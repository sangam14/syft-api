{"ast":null,"code":"import { createElementVNode as _createElementVNode, vModelSelect as _vModelSelect, withDirectives as _withDirectives, toDisplayString as _toDisplayString, createStaticVNode as _createStaticVNode, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\";\nconst _hoisted_1 = {\n  class: \"vulnerability-trend\"\n};\nconst _hoisted_2 = {\n  class: \"chart-header\"\n};\nconst _hoisted_3 = {\n  class: \"chart-filters\"\n};\nconst _hoisted_4 = {\n  class: \"chart-container\"\n};\nconst _hoisted_5 = {\n  ref: \"chartCanvas\"\n};\nconst _hoisted_6 = {\n  class: \"chart-summary\"\n};\nconst _hoisted_7 = {\n  class: \"summary-item\"\n};\nconst _hoisted_8 = {\n  class: \"summary-value\"\n};\nconst _hoisted_9 = {\n  class: \"summary-item\"\n};\nconst _hoisted_10 = {\n  class: \"summary-value\"\n};\nconst _hoisted_11 = {\n  class: \"summary-item\"\n};\nconst _hoisted_12 = {\n  class: \"summary-value\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_createElementVNode(\"div\", _hoisted_2, [_cache[4] || (_cache[4] = _createElementVNode(\"h3\", null, \"Vulnerability Trends\", -1 /* HOISTED */)), _createElementVNode(\"div\", _hoisted_3, [_withDirectives(_createElementVNode(\"select\", {\n    \"onUpdate:modelValue\": _cache[0] || (_cache[0] = $event => $setup.selectedTimeframe = $event),\n    class: \"modern-input\"\n  }, _cache[2] || (_cache[2] = [_createElementVNode(\"option\", {\n    value: \"7\"\n  }, \"Last 7 Days\", -1 /* HOISTED */), _createElementVNode(\"option\", {\n    value: \"30\"\n  }, \"Last 30 Days\", -1 /* HOISTED */), _createElementVNode(\"option\", {\n    value: \"90\"\n  }, \"Last 90 Days\", -1 /* HOISTED */), _createElementVNode(\"option\", {\n    value: \"365\"\n  }, \"Last Year\", -1 /* HOISTED */)]), 512 /* NEED_PATCH */), [[_vModelSelect, $setup.selectedTimeframe]]), _withDirectives(_createElementVNode(\"select\", {\n    \"onUpdate:modelValue\": _cache[1] || (_cache[1] = $event => $setup.selectedSeverity = $event),\n    class: \"modern-input\"\n  }, _cache[3] || (_cache[3] = [_createStaticVNode(\"<option value=\\\"all\\\" data-v-5f564431>All Severities</option><option value=\\\"critical\\\" data-v-5f564431>Critical</option><option value=\\\"high\\\" data-v-5f564431>High</option><option value=\\\"medium\\\" data-v-5f564431>Medium</option><option value=\\\"low\\\" data-v-5f564431>Low</option>\", 5)]), 512 /* NEED_PATCH */), [[_vModelSelect, $setup.selectedSeverity]])])]), _createElementVNode(\"div\", _hoisted_4, [_createElementVNode(\"canvas\", _hoisted_5, null, 512 /* NEED_PATCH */)]), _createElementVNode(\"div\", _hoisted_6, [_createElementVNode(\"div\", _hoisted_7, [_cache[5] || (_cache[5] = _createElementVNode(\"span\", {\n    class: \"summary-label\"\n  }, \"Total Vulnerabilities\", -1 /* HOISTED */)), _createElementVNode(\"span\", _hoisted_8, _toDisplayString($setup.totalVulnerabilities), 1 /* TEXT */)]), _createElementVNode(\"div\", _hoisted_9, [_cache[6] || (_cache[6] = _createElementVNode(\"span\", {\n    class: \"summary-label\"\n  }, \"Fixed\", -1 /* HOISTED */)), _createElementVNode(\"span\", _hoisted_10, _toDisplayString($setup.fixedVulnerabilities), 1 /* TEXT */)]), _createElementVNode(\"div\", _hoisted_11, [_cache[7] || (_cache[7] = _createElementVNode(\"span\", {\n    class: \"summary-label\"\n  }, \"New\", -1 /* HOISTED */)), _createElementVNode(\"span\", _hoisted_12, _toDisplayString($setup.newVulnerabilities), 1 /* TEXT */)])])]);\n}","map":{"version":3,"names":["class","ref","_createElementBlock","_hoisted_1","_createElementVNode","_hoisted_2","_hoisted_3","_cache","$event","$setup","selectedTimeframe","value","selectedSeverity","_createStaticVNode","_hoisted_4","_hoisted_5","_hoisted_6","_hoisted_7","_hoisted_8","_toDisplayString","totalVulnerabilities","_hoisted_9","_hoisted_10","fixedVulnerabilities","_hoisted_11","_hoisted_12","newVulnerabilities"],"sources":["/Users/sangambiradar/Documents/syft-api/static/vue-frontend/src/components/VulnerabilityTrend.vue"],"sourcesContent":["<template>\n  <div class=\"vulnerability-trend\">\n    <div class=\"chart-header\">\n      <h3>Vulnerability Trends</h3>\n      <div class=\"chart-filters\">\n        <select v-model=\"selectedTimeframe\" class=\"modern-input\">\n          <option value=\"7\">Last 7 Days</option>\n          <option value=\"30\">Last 30 Days</option>\n          <option value=\"90\">Last 90 Days</option>\n          <option value=\"365\">Last Year</option>\n        </select>\n        <select v-model=\"selectedSeverity\" class=\"modern-input\">\n          <option value=\"all\">All Severities</option>\n          <option value=\"critical\">Critical</option>\n          <option value=\"high\">High</option>\n          <option value=\"medium\">Medium</option>\n          <option value=\"low\">Low</option>\n        </select>\n      </div>\n    </div>\n    <div class=\"chart-container\">\n      <canvas ref=\"chartCanvas\"></canvas>\n    </div>\n    <div class=\"chart-summary\">\n      <div class=\"summary-item\">\n        <span class=\"summary-label\">Total Vulnerabilities</span>\n        <span class=\"summary-value\">{{ totalVulnerabilities }}</span>\n      </div>\n      <div class=\"summary-item\">\n        <span class=\"summary-label\">Fixed</span>\n        <span class=\"summary-value\">{{ fixedVulnerabilities }}</span>\n      </div>\n      <div class=\"summary-item\">\n        <span class=\"summary-label\">New</span>\n        <span class=\"summary-value\">{{ newVulnerabilities }}</span>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { ref, onMounted, watch, computed } from 'vue';\n// We're removing the Chart.js import and using the CDN version\n\nexport default {\n  name: 'VulnerabilityTrend',\n  props: {\n    sbomData: {\n      type: Object,\n      required: true\n    }\n  },\n  setup(props) {\n    const chartCanvas = ref(null);\n    const chart = ref(null);\n    const selectedTimeframe = ref('30');\n    const selectedSeverity = ref('all');\n\n    const vulnerabilityData = computed(() => {\n      if (!props.sbomData || !props.sbomData.components) {\n        return [];\n      }\n\n      const days = parseInt(selectedTimeframe.value);\n      const data = [];\n\n      for (let i = 0; i < days; i++) {\n        const date = new Date();\n        date.setDate(date.getDate() - i);\n        const dateStr = date.toISOString().split('T')[0];\n\n        data.push({\n          date: dateStr,\n          count: Math.floor(Math.random() * 10), // Placeholder - replace with actual data\n          severity: ['critical', 'high', 'medium', 'low'][Math.floor(Math.random() * 4)]\n        });\n      }\n\n      return data;\n    });\n\n    const totalVulnerabilities = computed(() => {\n      return vulnerabilityData.value.reduce((sum, item) => sum + item.count, 0);\n    });\n\n    const fixedVulnerabilities = computed(() => {\n      return Math.floor(totalVulnerabilities.value * 0.3); // Placeholder - replace with actual data\n    });\n\n    const newVulnerabilities = computed(() => {\n      return Math.floor(totalVulnerabilities.value * 0.1); // Placeholder - replace with actual data\n    });\n\n    const createChart = () => {\n      if (chart.value) {\n        chart.value.destroy();\n      }\n\n      if (!window.Chart) {\n        console.error('Chart.js not loaded');\n        return;\n      }\n\n      const ctx = chartCanvas.value.getContext('2d');\n      const filteredData = vulnerabilityData.value.filter(item => \n        selectedSeverity.value === 'all' || item.severity === selectedSeverity.value\n      );\n\n      chart.value = new window.Chart(ctx, {\n        type: 'line',\n        data: {\n          labels: filteredData.map(item => item.date),\n          datasets: [{\n            label: 'Vulnerabilities',\n            data: filteredData.map(item => item.count),\n            borderColor: '#2563eb',\n            backgroundColor: 'rgba(37, 99, 235, 0.1)',\n            tension: 0.4,\n            fill: true\n          }]\n        },\n        options: {\n          responsive: true,\n          maintainAspectRatio: false,\n          plugins: {\n            legend: {\n              display: false\n            }\n          },\n          scales: {\n            y: {\n              beginAtZero: true,\n              ticks: {\n                stepSize: 1\n              }\n            }\n          }\n        }\n      });\n    };\n\n    // Load Chart.js from CDN\n    const loadChartJs = () => {\n      return new Promise((resolve) => {\n        if (window.Chart) {\n          resolve();\n          return;\n        }\n\n        const script = document.createElement('script');\n        script.src = 'https://cdn.jsdelivr.net/npm/chart.js';\n        script.onload = () => resolve();\n        document.head.appendChild(script);\n      });\n    };\n\n    watch([selectedTimeframe, selectedSeverity], () => {\n      if (window.Chart) {\n        createChart();\n      }\n    });\n\n    onMounted(async () => {\n      await loadChartJs();\n      createChart();\n    });\n\n    return {\n      chartCanvas,\n      selectedTimeframe,\n      selectedSeverity,\n      totalVulnerabilities,\n      fixedVulnerabilities,\n      newVulnerabilities\n    };\n  }\n};\n</script>\n\n<style scoped>\n.vulnerability-trend {\n  background: white;\n  border-radius: 12px;\n  padding: 1.5rem;\n  box-shadow: var(--card-shadow);\n}\n\n.chart-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 1.5rem;\n}\n\n.chart-filters {\n  display: flex;\n  gap: 1rem;\n}\n\n.chart-container {\n  height: 300px;\n  margin-bottom: 1.5rem;\n}\n\n.chart-summary {\n  display: flex;\n  justify-content: space-around;\n  padding: 1rem;\n  background: var(--light-color);\n  border-radius: 8px;\n}\n\n.summary-item {\n  text-align: center;\n}\n\n.summary-label {\n  display: block;\n  font-size: var(--font-size-sm);\n  color: var(--secondary-color);\n  margin-bottom: 0.5rem;\n}\n\n.summary-value {\n  font-size: var(--font-size-xl);\n  font-weight: var(--font-weight-semibold);\n  color: var(--dark-color);\n}\n</style> "],"mappings":";;EACOA,KAAK,EAAC;AAAqB;;EACzBA,KAAK,EAAC;AAAc;;EAElBA,KAAK,EAAC;AAAe;;EAgBvBA,KAAK,EAAC;AAAiB;;EAClBC,GAAG,EAAC;AAAa;;EAEtBD,KAAK,EAAC;AAAe;;EACnBA,KAAK,EAAC;AAAc;;EAEjBA,KAAK,EAAC;AAAe;;EAExBA,KAAK,EAAC;AAAc;;EAEjBA,KAAK,EAAC;AAAe;;EAExBA,KAAK,EAAC;AAAc;;EAEjBA,KAAK,EAAC;AAAe;;uBAjCjCE,mBAAA,CAoCM,OApCNC,UAoCM,GAnCJC,mBAAA,CAiBM,OAjBNC,UAiBM,G,0BAhBJD,mBAAA,CAA6B,YAAzB,sBAAoB,sBACxBA,mBAAA,CAcM,OAdNE,UAcM,G,gBAbJF,mBAAA,CAKS;IAVjB,uBAAAG,MAAA,QAAAA,MAAA,MAAAC,MAAA,IAKyBC,MAAA,CAAAC,iBAAiB,GAAAF,MAAA;IAAER,KAAK,EAAC;gCACxCI,mBAAA,CAAsC;IAA9BO,KAAK,EAAC;EAAG,GAAC,aAAW,qBAC7BP,mBAAA,CAAwC;IAAhCO,KAAK,EAAC;EAAI,GAAC,cAAY,qBAC/BP,mBAAA,CAAwC;IAAhCO,KAAK,EAAC;EAAI,GAAC,cAAY,qBAC/BP,mBAAA,CAAsC;IAA9BO,KAAK,EAAC;EAAK,GAAC,WAAS,oB,2CAJdF,MAAA,CAAAC,iBAAiB,E,mBAMlCN,mBAAA,CAMS;IAjBjB,uBAAAG,MAAA,QAAAA,MAAA,MAAAC,MAAA,IAWyBC,MAAA,CAAAG,gBAAgB,GAAAJ,MAAA;IAAER,KAAK,EAAC;gCAXjDa,kBAAA,+R,2CAWyBJ,MAAA,CAAAG,gBAAgB,E,OASrCR,mBAAA,CAEM,OAFNU,UAEM,GADJV,mBAAA,CAAmC,UAAnCW,UAAmC,8B,GAErCX,mBAAA,CAaM,OAbNY,UAaM,GAZJZ,mBAAA,CAGM,OAHNa,UAGM,G,0BAFJb,mBAAA,CAAwD;IAAlDJ,KAAK,EAAC;EAAe,GAAC,uBAAqB,sBACjDI,mBAAA,CAA6D,QAA7Dc,UAA6D,EAAAC,gBAAA,CAA9BV,MAAA,CAAAW,oBAAoB,iB,GAErDhB,mBAAA,CAGM,OAHNiB,UAGM,G,0BAFJjB,mBAAA,CAAwC;IAAlCJ,KAAK,EAAC;EAAe,GAAC,OAAK,sBACjCI,mBAAA,CAA6D,QAA7DkB,WAA6D,EAAAH,gBAAA,CAA9BV,MAAA,CAAAc,oBAAoB,iB,GAErDnB,mBAAA,CAGM,OAHNoB,WAGM,G,0BAFJpB,mBAAA,CAAsC;IAAhCJ,KAAK,EAAC;EAAe,GAAC,KAAG,sBAC/BI,mBAAA,CAA2D,QAA3DqB,WAA2D,EAAAN,gBAAA,CAA5BV,MAAA,CAAAiB,kBAAkB,iB","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}