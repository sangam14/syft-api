{"ast":null,"code":"import { ref, computed, onMounted, watch } from 'vue';\nexport default {\n  name: 'PackageMetrics',\n  props: {\n    sbomData: {\n      type: Object,\n      required: true\n    }\n  },\n  setup(props) {\n    const searchQuery = ref('');\n    const selectedMetric = ref('downloads');\n    const isLoading = ref(false);\n    const packageCache = ref(new Map());\n    const debouncedSearchQuery = ref('');\n    const displayLimit = ref(10); // Default number of packages to display\n\n    // Debounce search input to prevent excessive filtering\n    let searchTimeout = null;\n    watch(searchQuery, newValue => {\n      if (searchTimeout) {\n        clearTimeout(searchTimeout);\n      }\n      searchTimeout = setTimeout(() => {\n        debouncedSearchQuery.value = newValue;\n      }, 300);\n    });\n\n    // Watch for changes in filtered packages to adjust display limit\n    watch(filteredPackages, newPackages => {\n      try {\n        // Ensure newPackages is an array\n        if (!newPackages) {\n          console.log('newPackages is undefined in filteredPackages watcher');\n          displayLimit.value = 10; // Reset to default\n          return;\n        }\n        if (!Array.isArray(newPackages)) {\n          console.log('newPackages is not an array in filteredPackages watcher');\n          displayLimit.value = 10; // Reset to default\n          return;\n        }\n\n        // If current display limit is greater than available packages, adjust it\n        if (displayLimit.value > newPackages.length) {\n          displayLimit.value = Math.max(5, newPackages.length);\n        }\n\n        // If we have no packages, reset to default\n        if (newPackages.length === 0) {\n          displayLimit.value = 10; // Reset to default for next time\n        }\n      } catch (error) {\n        console.error('Error in filteredPackages watcher:', error);\n        // Set a safe default\n        displayLimit.value = 10;\n      }\n    });\n\n    // Generate deterministic data based on component properties\n    const generatePackageData = component => {\n      // Create a simple hash from the component name for deterministic values\n      const nameHash = component.name.split('').reduce((acc, char) => {\n        return acc + char.charCodeAt(0);\n      }, 0);\n\n      // Use the hash to generate deterministic values\n      const downloads = nameHash * 1000 % 10000000;\n      const stars = nameHash * 100 % 50000;\n      const issues = nameHash * 10 % 50;\n      const maintenanceScore = nameHash * 5 % 100;\n\n      // Generate a deterministic date within the last year\n      const today = new Date();\n      const daysAgo = nameHash % 365 + 1;\n      const lastUpdated = new Date(today);\n      lastUpdated.setDate(lastUpdated.getDate() - daysAgo);\n      return {\n        name: component.name,\n        version: component.version,\n        downloads: Math.floor(downloads),\n        stars: Math.floor(stars),\n        issues: Math.floor(issues),\n        lastUpdated: lastUpdated.toISOString().split('T')[0],\n        maintenanceScore: Math.floor(maintenanceScore)\n      };\n    };\n\n    // Use memoization to avoid recalculating package data\n    const getPackageData = component => {\n      const cacheKey = `${component.name}-${component.version}`;\n      if (!packageCache.value.has(cacheKey)) {\n        packageCache.value.set(cacheKey, generatePackageData(component));\n      }\n      return packageCache.value.get(cacheKey);\n    };\n\n    // Optimized computed property with memoization\n    const packages = computed(() => {\n      try {\n        // Check if sbomData exists and has components array\n        if (!props.sbomData) {\n          console.log('No sbomData provided to PackageMetrics');\n          return [];\n        }\n\n        // Handle case where sbomData might be a string\n        let componentsArray = [];\n        if (typeof props.sbomData === 'string') {\n          try {\n            const parsed = JSON.parse(props.sbomData);\n            componentsArray = parsed.components || [];\n          } catch (parseError) {\n            console.error('Error parsing sbomData string:', parseError);\n            return [];\n          }\n        } else if (props.sbomData.components && Array.isArray(props.sbomData.components)) {\n          componentsArray = props.sbomData.components;\n        } else {\n          console.log('sbomData does not contain a valid components array');\n          return [];\n        }\n\n        // Map components to package data\n        return componentsArray.map(component => {\n          // Ensure component has required properties\n          if (!component || !component.name) {\n            return {\n              name: 'Unknown',\n              version: 'Unknown',\n              downloads: 0,\n              stars: 0,\n              issues: 0,\n              lastUpdated: new Date().toISOString().split('T')[0],\n              maintenanceScore: 0\n            };\n          }\n          return getPackageData(component);\n        });\n      } catch (error) {\n        console.error('Error in packages computed property:', error);\n        return [];\n      }\n    });\n\n    // Total number of packages\n    const totalPackages = computed(() => packages.value ? packages.value.length : 0);\n\n    // Optimized filtering and sorting with memoization\n    const filteredPackages = computed(() => {\n      try {\n        // Ensure packages exists and is an array\n        if (!packages.value || !Array.isArray(packages.value)) {\n          console.log('packages is not an array in filteredPackages');\n          return [];\n        }\n\n        // Get query and metric with fallbacks\n        const query = (debouncedSearchQuery.value || '').toLowerCase();\n        const metric = selectedMetric.value || 'downloads';\n\n        // Create a safe copy of the packages array\n        const safePackages = [...packages.value];\n\n        // Filter packages based on search query\n        const filtered = query ? safePackages.filter(pkg => {\n          // Ensure pkg and pkg.name exist\n          if (!pkg || typeof pkg.name !== 'string') return false;\n          return pkg.name.toLowerCase().includes(query);\n        }) : safePackages;\n\n        // Sort packages based on selected metric\n        return filtered.sort((a, b) => {\n          // Handle null or undefined values\n          if (!a && !b) return 0;\n          if (!a) return 1; // b comes first\n          if (!b) return -1; // a comes first\n\n          switch (metric) {\n            case 'downloads':\n              return (b.downloads || 0) - (a.downloads || 0);\n            case 'stars':\n              return (b.stars || 0) - (a.stars || 0);\n            case 'issues':\n              return (a.issues || 0) - (b.issues || 0);\n            // Lower is better for issues\n            case 'maintenance':\n              return (b.maintenanceScore || 0) - (a.maintenanceScore || 0);\n            default:\n              return 0;\n          }\n        });\n      } catch (error) {\n        console.error('Error in filteredPackages computed property:', error);\n        return [];\n      }\n    });\n\n    // Calculate average metrics for summary\n    const averageDownloads = computed(() => {\n      if (!filteredPackages.value || filteredPackages.value.length === 0) return 0;\n      const sum = filteredPackages.value.reduce((acc, pkg) => acc + (pkg?.downloads || 0), 0);\n      return Math.round(sum / filteredPackages.value.length);\n    });\n    const averageStars = computed(() => {\n      if (!filteredPackages.value || filteredPackages.value.length === 0) return 0;\n      const sum = filteredPackages.value.reduce((acc, pkg) => acc + (pkg?.stars || 0), 0);\n      return Math.round(sum / filteredPackages.value.length);\n    });\n    const averageMaintenance = computed(() => {\n      if (!filteredPackages.value || filteredPackages.value.length === 0) return 0;\n      const sum = filteredPackages.value.reduce((acc, pkg) => acc + (pkg?.maintenanceScore || 0), 0);\n      return Math.round(sum / filteredPackages.value.length);\n    });\n\n    // Watch for changes in display limit to validate it\n    watch(displayLimit, () => {\n      validateDisplayLimit();\n    });\n\n    // Displayed packages with limit applied\n    const displayedPackages = computed(() => {\n      try {\n        // Ensure filteredPackages exists and has a length property\n        if (!filteredPackages.value) {\n          console.log('filteredPackages is undefined in displayedPackages');\n          return [];\n        }\n        if (!Array.isArray(filteredPackages.value)) {\n          console.log('filteredPackages is not an array in displayedPackages');\n          return [];\n        }\n        if (filteredPackages.value.length === 0) {\n          return [];\n        }\n\n        // Ensure displayLimit is a valid number\n        const numLimit = Number(displayLimit.value);\n        const validLimit = isNaN(numLimit) ? 5 : numLimit;\n        const limit = Math.max(5, Math.min(filteredPackages.value.length, validLimit));\n\n        // If the limit needs correction, we'll handle it in the next tick via the watcher\n        // This avoids modifying state in computed properties\n\n        return filteredPackages.value.slice(0, limit);\n      } catch (error) {\n        console.error('Error in displayedPackages computed property:', error);\n        return [];\n      }\n    });\n\n    // Functions to increase/decrease the display limit\n    function increaseRange() {\n      try {\n        // Safely get the maximum available packages\n        let maxPackages = 0;\n        if (filteredPackages.value && Array.isArray(filteredPackages.value)) {\n          maxPackages = filteredPackages.value.length;\n        } else {\n          console.log('filteredPackages is not valid in increaseRange');\n          // Default to a reasonable value if we can't determine the actual max\n          maxPackages = 20;\n        }\n\n        // Get current display limit as a number with fallback\n        const currentLimit = Number(displayLimit.value) || 5;\n\n        // Increase by 5, but don't exceed maxPackages\n        displayLimit.value = Math.min(maxPackages, currentLimit + 5);\n      } catch (error) {\n        console.error('Error in increaseRange function:', error);\n      }\n    }\n    function decreaseRange() {\n      try {\n        // Get current display limit as a number with fallback\n        const currentLimit = Number(displayLimit.value) || 10;\n\n        // Decrease by 5, but don't go below 5\n        displayLimit.value = Math.max(5, currentLimit - 5);\n      } catch (error) {\n        console.error('Error in decreaseRange function:', error);\n        // Set a safe default\n        displayLimit.value = 5;\n      }\n    }\n\n    // Validate and correct the display limit if needed\n    function validateDisplayLimit() {\n      try {\n        // Convert to number in case it's a string from the input\n        const numValue = Number(displayLimit.value);\n\n        // Handle NaN or invalid values\n        if (isNaN(numValue) || numValue < 5) {\n          displayLimit.value = 5;\n          return;\n        }\n\n        // Safely get the maximum available packages\n        let maxPackages = 0;\n        if (filteredPackages.value && Array.isArray(filteredPackages.value)) {\n          maxPackages = filteredPackages.value.length;\n        } else {\n          console.log('filteredPackages is not valid in validateDisplayLimit');\n          // Default to 10 if we can't determine the actual max\n          maxPackages = 10;\n        }\n        if (numValue > maxPackages && maxPackages > 0) {\n          displayLimit.value = maxPackages;\n          return;\n        }\n\n        // Ensure it's an integer\n        displayLimit.value = Math.floor(numValue);\n      } catch (error) {\n        console.error('Error in validateDisplayLimit function:', error);\n        // Set a safe default\n        displayLimit.value = 5;\n      }\n    }\n\n    // Optimized number formatter with memoization\n    const numberFormatCache = new Map();\n    const formatNumber = num => {\n      try {\n        // Handle undefined, null, or NaN\n        if (num === undefined || num === null || isNaN(num)) {\n          return '0';\n        }\n\n        // Ensure num is a number\n        const numValue = Number(num);\n\n        // Check cache first\n        if (numberFormatCache.has(numValue)) {\n          return numberFormatCache.get(numValue);\n        }\n        let result;\n        if (numValue >= 1000000) {\n          result = (numValue / 1000000).toFixed(1) + 'M';\n        } else if (numValue >= 1000) {\n          result = (numValue / 1000).toFixed(1) + 'K';\n        } else {\n          result = numValue.toString();\n        }\n\n        // Cache the result\n        numberFormatCache.set(numValue, result);\n        return result;\n      } catch (error) {\n        console.error('Error in formatNumber function:', error);\n        return '0';\n      }\n    };\n\n    // Optimized date formatter with memoization\n    const dateFormatCache = new Map();\n    const formatDate = dateString => {\n      try {\n        // Handle undefined or null\n        if (!dateString) {\n          return 'Unknown date';\n        }\n\n        // Check cache first\n        if (dateFormatCache.has(dateString)) {\n          return dateFormatCache.get(dateString);\n        }\n\n        // Try to create a valid date\n        const date = new Date(dateString);\n\n        // Check if date is valid\n        if (isNaN(date.getTime())) {\n          return 'Invalid date';\n        }\n        const result = date.toLocaleDateString('en-US', {\n          year: 'numeric',\n          month: 'short',\n          day: 'numeric'\n        });\n\n        // Cache the result\n        dateFormatCache.set(dateString, result);\n        return result;\n      } catch (error) {\n        console.error('Error in formatDate function:', error);\n        return 'Unknown date';\n      }\n    };\n\n    // Optimized class getter with memoization\n    const maintenanceClassCache = new Map();\n    const getMaintenanceClass = score => {\n      // Check cache first\n      if (maintenanceClassCache.has(score)) {\n        return maintenanceClassCache.get(score);\n      }\n      let result;\n      if (score >= 90) result = 'excellent';else if (score >= 75) result = 'good';else if (score >= 60) result = 'fair';else result = 'poor';\n\n      // Cache the result\n      maintenanceClassCache.set(score, result);\n      return result;\n    };\n\n    // Simulate loading state for better UX\n    onMounted(() => {\n      isLoading.value = true;\n      setTimeout(() => {\n        isLoading.value = false;\n      }, 500);\n    });\n    return {\n      searchQuery,\n      selectedMetric,\n      filteredPackages,\n      displayedPackages,\n      totalPackages,\n      displayLimit,\n      increaseRange,\n      decreaseRange,\n      validateDisplayLimit,\n      formatNumber,\n      formatDate,\n      getMaintenanceClass,\n      isLoading,\n      averageDownloads,\n      averageStars,\n      averageMaintenance\n    };\n  }\n};","map":{"version":3,"names":["ref","computed","onMounted","watch","name","props","sbomData","type","Object","required","setup","searchQuery","selectedMetric","isLoading","packageCache","Map","debouncedSearchQuery","displayLimit","searchTimeout","newValue","clearTimeout","setTimeout","value","filteredPackages","newPackages","console","log","Array","isArray","length","Math","max","error","generatePackageData","component","nameHash","split","reduce","acc","char","charCodeAt","downloads","stars","issues","maintenanceScore","today","Date","daysAgo","lastUpdated","setDate","getDate","version","floor","toISOString","getPackageData","cacheKey","has","set","get","packages","componentsArray","parsed","JSON","parse","components","parseError","map","totalPackages","query","toLowerCase","metric","safePackages","filtered","filter","pkg","includes","sort","a","b","averageDownloads","sum","round","averageStars","averageMaintenance","validateDisplayLimit","displayedPackages","numLimit","Number","validLimit","isNaN","limit","min","slice","increaseRange","maxPackages","currentLimit","decreaseRange","numValue","numberFormatCache","formatNumber","num","undefined","result","toFixed","toString","dateFormatCache","formatDate","dateString","date","getTime","toLocaleDateString","year","month","day","maintenanceClassCache","getMaintenanceClass","score"],"sources":["/Users/sangambiradar/Documents/syft-api/static/vue-frontend/src/components/PackageMetrics.vue"],"sourcesContent":["<template>\n  <div class=\"package-metrics\">\n    <div class=\"metrics-header\">\n      <div class=\"metrics-title\">\n        <h3>Package Metrics</h3>\n        <span class=\"package-count\" v-if=\"!isLoading && displayedPackages && Array.isArray(displayedPackages)\">{{ displayedPackages.length || 0 }} / {{ totalPackages || 0 }} packages</span>\n      </div>\n      <div class=\"metrics-filters\">\n        <div class=\"filter-group\">\n          <input\n            type=\"text\"\n            v-model=\"searchQuery\"\n            placeholder=\"Search packages...\"\n            class=\"modern-input\"\n          />\n          <select v-model=\"selectedMetric\" class=\"modern-input\">\n            <option value=\"downloads\">Downloads</option>\n            <option value=\"stars\">GitHub Stars</option>\n            <option value=\"issues\">Open Issues</option>\n            <option value=\"maintenance\">Maintenance Score</option>\n          </select>\n        </div>\n        <div class=\"range-selector\">\n          <label for=\"packageRange\">Show:</label>\n          <div class=\"range-inputs\">\n            <input\n              type=\"number\"\n              id=\"packageRange\"\n              v-model.number=\"displayLimit\"\n              min=\"5\"\n              :max=\"filteredPackages.length\"\n              @change=\"validateDisplayLimit\"\n              class=\"modern-input range-input\"\n            />\n            <div class=\"range-controls\">\n              <button\n                @click=\"increaseRange\"\n                class=\"range-button\"\n                :disabled=\"displayLimit >= filteredPackages.length\"\n                title=\"Show more packages\"\n              >+</button>\n              <button\n                @click=\"decreaseRange\"\n                class=\"range-button\"\n                :disabled=\"displayLimit <= 5\"\n                title=\"Show fewer packages\"\n              >-</button>\n            </div>\n          </div>\n          <span class=\"range-info\" v-if=\"filteredPackages.length > 0\">\n            of {{ filteredPackages.length }}\n          </span>\n        </div>\n      </div>\n    </div>\n\n    <!-- Loading state -->\n    <div v-if=\"isLoading\" class=\"loading-state\">\n      <div class=\"loading-spinner\"></div>\n      <p>Loading package metrics...</p>\n    </div>\n\n    <!-- Empty state when no packages match the filter -->\n    <div v-else-if=\"filteredPackages.length === 0\" class=\"empty-state\">\n      <div class=\"empty-icon\">📦</div>\n      <p v-if=\"searchQuery\">No packages match your search criteria \"{{ searchQuery }}\".</p>\n      <p v-else>No package data available.</p>\n      <button\n        v-if=\"searchQuery && packages.length > 0\"\n        @click=\"searchQuery = ''\"\n        class=\"reset-button\"\n      >\n        Clear Search\n      </button>\n    </div>\n\n    <!-- Package summary section -->\n    <div v-else-if=\"filteredPackages.length > 0\" class=\"metrics-content\">\n      <div class=\"package-summary\" v-if=\"filteredPackages.length > 1\">\n        <div class=\"summary-item\">\n          <div class=\"summary-label\">Total Packages</div>\n          <div class=\"summary-value\">{{ filteredPackages.length }}</div>\n        </div>\n        <div class=\"summary-item\">\n          <div class=\"summary-label\">Avg. Downloads</div>\n          <div class=\"summary-value\">{{ formatNumber(averageDownloads) }}</div>\n        </div>\n        <div class=\"summary-item\">\n          <div class=\"summary-label\">Avg. Stars</div>\n          <div class=\"summary-value\">{{ formatNumber(averageStars) }}</div>\n        </div>\n        <div class=\"summary-item\">\n          <div class=\"summary-label\">Avg. Maintenance</div>\n          <div class=\"summary-value\" :class=\"getMaintenanceClass(averageMaintenance)\">{{ averageMaintenance }}%</div>\n        </div>\n      </div>\n\n      <!-- Package metrics grid -->\n      <div class=\"metrics-grid\">\n        <div v-if=\"!displayedPackages || !Array.isArray(displayedPackages) || displayedPackages.length === 0\" class=\"empty-metrics\">\n          <p>No package metrics available to display.</p>\n        </div>\n        <div v-else v-for=\"pkg in displayedPackages\" :key=\"pkg?.name || 'unknown'\" class=\"metric-card\">\n          <div class=\"metric-header\">\n            <h4>{{ pkg?.name || 'Unknown Package' }}</h4>\n            <span class=\"metric-badge\" :class=\"getMaintenanceClass(pkg?.maintenanceScore || 0)\">\n              {{ pkg?.maintenanceScore || 0 }}%\n            </span>\n          </div>\n\n          <div class=\"metric-details\">\n            <div class=\"metric-row\">\n              <span class=\"metric-label\">Downloads</span>\n              <span class=\"metric-value\">{{ formatNumber(pkg?.downloads || 0) }}</span>\n            </div>\n            <div class=\"metric-row\">\n              <span class=\"metric-label\">Stars</span>\n              <span class=\"metric-value\">{{ formatNumber(pkg?.stars || 0) }}</span>\n            </div>\n            <div class=\"metric-row\">\n              <span class=\"metric-label\">Open Issues</span>\n              <span class=\"metric-value\">{{ pkg?.issues || 0 }}</span>\n            </div>\n            <div class=\"metric-row\">\n              <span class=\"metric-label\">Last Updated</span>\n              <span class=\"metric-value\">{{ formatDate(pkg?.lastUpdated || new Date().toISOString()) }}</span>\n            </div>\n          </div>\n\n          <div class=\"metric-progress\">\n            <div class=\"progress-bar\">\n              <div\n                class=\"progress-fill\"\n                :style=\"{ width: `${pkg?.maintenanceScore || 0}%` }\"\n                :class=\"getMaintenanceClass(pkg?.maintenanceScore || 0)\"\n              ></div>\n            </div>\n            <span class=\"progress-label\">Maintenance Score</span>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { ref, computed, onMounted, watch } from 'vue';\n\nexport default {\n  name: 'PackageMetrics',\n  props: {\n    sbomData: {\n      type: Object,\n      required: true\n    }\n  },\n  setup(props) {\n    const searchQuery = ref('');\n    const selectedMetric = ref('downloads');\n    const isLoading = ref(false);\n    const packageCache = ref(new Map());\n    const debouncedSearchQuery = ref('');\n    const displayLimit = ref(10); // Default number of packages to display\n\n    // Debounce search input to prevent excessive filtering\n    let searchTimeout = null;\n\n    watch(searchQuery, (newValue) => {\n      if (searchTimeout) {\n        clearTimeout(searchTimeout);\n      }\n\n      searchTimeout = setTimeout(() => {\n        debouncedSearchQuery.value = newValue;\n      }, 300);\n    });\n\n    // Watch for changes in filtered packages to adjust display limit\n    watch(filteredPackages, (newPackages) => {\n      try {\n        // Ensure newPackages is an array\n        if (!newPackages) {\n          console.log('newPackages is undefined in filteredPackages watcher');\n          displayLimit.value = 10; // Reset to default\n          return;\n        }\n\n        if (!Array.isArray(newPackages)) {\n          console.log('newPackages is not an array in filteredPackages watcher');\n          displayLimit.value = 10; // Reset to default\n          return;\n        }\n\n        // If current display limit is greater than available packages, adjust it\n        if (displayLimit.value > newPackages.length) {\n          displayLimit.value = Math.max(5, newPackages.length);\n        }\n\n        // If we have no packages, reset to default\n        if (newPackages.length === 0) {\n          displayLimit.value = 10; // Reset to default for next time\n        }\n      } catch (error) {\n        console.error('Error in filteredPackages watcher:', error);\n        // Set a safe default\n        displayLimit.value = 10;\n      }\n    });\n\n    // Generate deterministic data based on component properties\n    const generatePackageData = (component) => {\n      // Create a simple hash from the component name for deterministic values\n      const nameHash = component.name.split('').reduce((acc, char) => {\n        return acc + char.charCodeAt(0);\n      }, 0);\n\n      // Use the hash to generate deterministic values\n      const downloads = (nameHash * 1000) % 10000000;\n      const stars = (nameHash * 100) % 50000;\n      const issues = (nameHash * 10) % 50;\n      const maintenanceScore = (nameHash * 5) % 100;\n\n      // Generate a deterministic date within the last year\n      const today = new Date();\n      const daysAgo = (nameHash % 365) + 1;\n      const lastUpdated = new Date(today);\n      lastUpdated.setDate(lastUpdated.getDate() - daysAgo);\n\n      return {\n        name: component.name,\n        version: component.version,\n        downloads: Math.floor(downloads),\n        stars: Math.floor(stars),\n        issues: Math.floor(issues),\n        lastUpdated: lastUpdated.toISOString().split('T')[0],\n        maintenanceScore: Math.floor(maintenanceScore)\n      };\n    };\n\n    // Use memoization to avoid recalculating package data\n    const getPackageData = (component) => {\n      const cacheKey = `${component.name}-${component.version}`;\n\n      if (!packageCache.value.has(cacheKey)) {\n        packageCache.value.set(cacheKey, generatePackageData(component));\n      }\n\n      return packageCache.value.get(cacheKey);\n    };\n\n    // Optimized computed property with memoization\n    const packages = computed(() => {\n      try {\n        // Check if sbomData exists and has components array\n        if (!props.sbomData) {\n          console.log('No sbomData provided to PackageMetrics');\n          return [];\n        }\n\n        // Handle case where sbomData might be a string\n        let componentsArray = [];\n\n        if (typeof props.sbomData === 'string') {\n          try {\n            const parsed = JSON.parse(props.sbomData);\n            componentsArray = parsed.components || [];\n          } catch (parseError) {\n            console.error('Error parsing sbomData string:', parseError);\n            return [];\n          }\n        } else if (props.sbomData.components && Array.isArray(props.sbomData.components)) {\n          componentsArray = props.sbomData.components;\n        } else {\n          console.log('sbomData does not contain a valid components array');\n          return [];\n        }\n\n        // Map components to package data\n        return componentsArray.map(component => {\n          // Ensure component has required properties\n          if (!component || !component.name) {\n            return {\n              name: 'Unknown',\n              version: 'Unknown',\n              downloads: 0,\n              stars: 0,\n              issues: 0,\n              lastUpdated: new Date().toISOString().split('T')[0],\n              maintenanceScore: 0\n            };\n          }\n          return getPackageData(component);\n        });\n      } catch (error) {\n        console.error('Error in packages computed property:', error);\n        return [];\n      }\n    });\n\n    // Total number of packages\n    const totalPackages = computed(() => packages.value ? packages.value.length : 0);\n\n    // Optimized filtering and sorting with memoization\n    const filteredPackages = computed(() => {\n      try {\n        // Ensure packages exists and is an array\n        if (!packages.value || !Array.isArray(packages.value)) {\n          console.log('packages is not an array in filteredPackages');\n          return [];\n        }\n\n        // Get query and metric with fallbacks\n        const query = (debouncedSearchQuery.value || '').toLowerCase();\n        const metric = selectedMetric.value || 'downloads';\n\n        // Create a safe copy of the packages array\n        const safePackages = [...packages.value];\n\n        // Filter packages based on search query\n        const filtered = query\n          ? safePackages.filter(pkg => {\n              // Ensure pkg and pkg.name exist\n              if (!pkg || typeof pkg.name !== 'string') return false;\n              return pkg.name.toLowerCase().includes(query);\n            })\n          : safePackages;\n\n        // Sort packages based on selected metric\n        return filtered.sort((a, b) => {\n          // Handle null or undefined values\n          if (!a && !b) return 0;\n          if (!a) return 1; // b comes first\n          if (!b) return -1; // a comes first\n\n          switch (metric) {\n            case 'downloads':\n              return (b.downloads || 0) - (a.downloads || 0);\n            case 'stars':\n              return (b.stars || 0) - (a.stars || 0);\n            case 'issues':\n              return (a.issues || 0) - (b.issues || 0); // Lower is better for issues\n            case 'maintenance':\n              return (b.maintenanceScore || 0) - (a.maintenanceScore || 0);\n            default:\n              return 0;\n          }\n        });\n      } catch (error) {\n        console.error('Error in filteredPackages computed property:', error);\n        return [];\n      }\n    });\n\n\n    // Calculate average metrics for summary\n    const averageDownloads = computed(() => {\n      if (!filteredPackages.value || filteredPackages.value.length === 0) return 0;\n      const sum = filteredPackages.value.reduce((acc, pkg) => acc + (pkg?.downloads || 0), 0);\n      return Math.round(sum / filteredPackages.value.length);\n    });\n\n    const averageStars = computed(() => {\n      if (!filteredPackages.value || filteredPackages.value.length === 0) return 0;\n      const sum = filteredPackages.value.reduce((acc, pkg) => acc + (pkg?.stars || 0), 0);\n      return Math.round(sum / filteredPackages.value.length);\n    });\n\n    const averageMaintenance = computed(() => {\n      if (!filteredPackages.value || filteredPackages.value.length === 0) return 0;\n      const sum = filteredPackages.value.reduce((acc, pkg) => acc + (pkg?.maintenanceScore || 0), 0);\n      return Math.round(sum / filteredPackages.value.length);\n    });\n\n    // Watch for changes in display limit to validate it\n    watch(displayLimit, () => {\n      validateDisplayLimit();\n    });\n\n    // Displayed packages with limit applied\n    const displayedPackages = computed(() => {\n      try {\n        // Ensure filteredPackages exists and has a length property\n        if (!filteredPackages.value) {\n          console.log('filteredPackages is undefined in displayedPackages');\n          return [];\n        }\n\n        if (!Array.isArray(filteredPackages.value)) {\n          console.log('filteredPackages is not an array in displayedPackages');\n          return [];\n        }\n\n        if (filteredPackages.value.length === 0) {\n          return [];\n        }\n\n        // Ensure displayLimit is a valid number\n        const numLimit = Number(displayLimit.value);\n        const validLimit = isNaN(numLimit) ? 5 : numLimit;\n        const limit = Math.max(5, Math.min(filteredPackages.value.length, validLimit));\n\n        // If the limit needs correction, we'll handle it in the next tick via the watcher\n        // This avoids modifying state in computed properties\n\n        return filteredPackages.value.slice(0, limit);\n      } catch (error) {\n        console.error('Error in displayedPackages computed property:', error);\n        return [];\n      }\n    });\n\n    // Functions to increase/decrease the display limit\n    function increaseRange() {\n      try {\n        // Safely get the maximum available packages\n        let maxPackages = 0;\n\n        if (filteredPackages.value && Array.isArray(filteredPackages.value)) {\n          maxPackages = filteredPackages.value.length;\n        } else {\n          console.log('filteredPackages is not valid in increaseRange');\n          // Default to a reasonable value if we can't determine the actual max\n          maxPackages = 20;\n        }\n\n        // Get current display limit as a number with fallback\n        const currentLimit = Number(displayLimit.value) || 5;\n\n        // Increase by 5, but don't exceed maxPackages\n        displayLimit.value = Math.min(maxPackages, currentLimit + 5);\n      } catch (error) {\n        console.error('Error in increaseRange function:', error);\n      }\n    }\n\n    function decreaseRange() {\n      try {\n        // Get current display limit as a number with fallback\n        const currentLimit = Number(displayLimit.value) || 10;\n\n        // Decrease by 5, but don't go below 5\n        displayLimit.value = Math.max(5, currentLimit - 5);\n      } catch (error) {\n        console.error('Error in decreaseRange function:', error);\n        // Set a safe default\n        displayLimit.value = 5;\n      }\n    }\n\n    // Validate and correct the display limit if needed\n    function validateDisplayLimit() {\n      try {\n        // Convert to number in case it's a string from the input\n        const numValue = Number(displayLimit.value);\n\n        // Handle NaN or invalid values\n        if (isNaN(numValue) || numValue < 5) {\n          displayLimit.value = 5;\n          return;\n        }\n\n        // Safely get the maximum available packages\n        let maxPackages = 0;\n\n        if (filteredPackages.value && Array.isArray(filteredPackages.value)) {\n          maxPackages = filteredPackages.value.length;\n        } else {\n          console.log('filteredPackages is not valid in validateDisplayLimit');\n          // Default to 10 if we can't determine the actual max\n          maxPackages = 10;\n        }\n\n        if (numValue > maxPackages && maxPackages > 0) {\n          displayLimit.value = maxPackages;\n          return;\n        }\n\n        // Ensure it's an integer\n        displayLimit.value = Math.floor(numValue);\n      } catch (error) {\n        console.error('Error in validateDisplayLimit function:', error);\n        // Set a safe default\n        displayLimit.value = 5;\n      }\n    }\n\n    // Optimized number formatter with memoization\n    const numberFormatCache = new Map();\n\n    const formatNumber = (num) => {\n      try {\n        // Handle undefined, null, or NaN\n        if (num === undefined || num === null || isNaN(num)) {\n          return '0';\n        }\n\n        // Ensure num is a number\n        const numValue = Number(num);\n\n        // Check cache first\n        if (numberFormatCache.has(numValue)) {\n          return numberFormatCache.get(numValue);\n        }\n\n        let result;\n        if (numValue >= 1000000) {\n          result = (numValue / 1000000).toFixed(1) + 'M';\n        } else if (numValue >= 1000) {\n          result = (numValue / 1000).toFixed(1) + 'K';\n        } else {\n          result = numValue.toString();\n        }\n\n        // Cache the result\n        numberFormatCache.set(numValue, result);\n        return result;\n      } catch (error) {\n        console.error('Error in formatNumber function:', error);\n        return '0';\n      }\n    };\n\n    // Optimized date formatter with memoization\n    const dateFormatCache = new Map();\n\n    const formatDate = (dateString) => {\n      try {\n        // Handle undefined or null\n        if (!dateString) {\n          return 'Unknown date';\n        }\n\n        // Check cache first\n        if (dateFormatCache.has(dateString)) {\n          return dateFormatCache.get(dateString);\n        }\n\n        // Try to create a valid date\n        const date = new Date(dateString);\n\n        // Check if date is valid\n        if (isNaN(date.getTime())) {\n          return 'Invalid date';\n        }\n\n        const result = date.toLocaleDateString('en-US', {\n          year: 'numeric',\n          month: 'short',\n          day: 'numeric'\n        });\n\n        // Cache the result\n        dateFormatCache.set(dateString, result);\n        return result;\n      } catch (error) {\n        console.error('Error in formatDate function:', error);\n        return 'Unknown date';\n      }\n    };\n\n    // Optimized class getter with memoization\n    const maintenanceClassCache = new Map();\n\n    const getMaintenanceClass = (score) => {\n      // Check cache first\n      if (maintenanceClassCache.has(score)) {\n        return maintenanceClassCache.get(score);\n      }\n\n      let result;\n      if (score >= 90) result = 'excellent';\n      else if (score >= 75) result = 'good';\n      else if (score >= 60) result = 'fair';\n      else result = 'poor';\n\n      // Cache the result\n      maintenanceClassCache.set(score, result);\n      return result;\n    };\n\n    // Simulate loading state for better UX\n    onMounted(() => {\n      isLoading.value = true;\n      setTimeout(() => {\n        isLoading.value = false;\n      }, 500);\n    });\n\n    return {\n      searchQuery,\n      selectedMetric,\n      filteredPackages,\n      displayedPackages,\n      totalPackages,\n      displayLimit,\n      increaseRange,\n      decreaseRange,\n      validateDisplayLimit,\n      formatNumber,\n      formatDate,\n      getMaintenanceClass,\n      isLoading,\n      averageDownloads,\n      averageStars,\n      averageMaintenance\n    };\n  }\n};\n</script>\n\n<style scoped>\n.package-metrics {\n  background: white;\n  border-radius: 12px;\n  padding: 1.5rem;\n  box-shadow: var(--card-shadow);\n}\n\n.metrics-header {\n  display: flex;\n  flex-direction: column;\n  margin-bottom: 2rem;\n}\n\n.metrics-title {\n  display: flex;\n  align-items: center;\n  margin-bottom: 1rem;\n}\n\n.metrics-header h3 {\n  font-size: var(--font-size-xl);\n  font-weight: var(--font-weight-semibold);\n  color: var(--dark-color);\n  margin-right: 1rem;\n  margin-bottom: 0;\n}\n\n.package-count {\n  font-size: var(--font-size-sm);\n  color: var(--secondary-color);\n  background-color: var(--light-color);\n  padding: 0.25rem 0.75rem;\n  border-radius: 9999px;\n}\n\n.metrics-filters {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  flex-wrap: wrap;\n  gap: 1rem;\n}\n\n.filter-group {\n  display: flex;\n  gap: 1rem;\n  flex-wrap: wrap;\n}\n\n.metrics-filters input {\n  width: 200px;\n}\n\n.range-selector {\n  display: flex;\n  align-items: center;\n  gap: 0.75rem;\n  position: relative;\n}\n\n.range-selector label {\n  font-size: var(--font-size-sm);\n  color: var(--secondary-color);\n  white-space: nowrap;\n}\n\n.range-inputs {\n  display: flex;\n  align-items: center;\n}\n\n.range-input {\n  width: 70px;\n  text-align: center;\n  padding-right: 0.5rem;\n}\n\n.range-info {\n  font-size: var(--font-size-sm);\n  color: var(--secondary-color);\n  white-space: nowrap;\n  margin-left: 0.25rem;\n}\n\n.range-controls {\n  display: flex;\n  flex-direction: column;\n  margin-left: 0.5rem;\n}\n\n.range-button {\n  background-color: var(--light-color);\n  border: 1px solid var(--border-color);\n  color: var(--dark-color);\n  width: 24px;\n  height: 24px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  cursor: pointer;\n  padding: 0;\n  font-size: var(--font-size-sm);\n  transition: all 0.2s ease;\n}\n\n.range-button:first-child {\n  border-top-left-radius: 4px;\n  border-top-right-radius: 4px;\n  border-bottom: none;\n}\n\n.range-button:last-child {\n  border-bottom-left-radius: 4px;\n  border-bottom-right-radius: 4px;\n}\n\n.range-button:hover:not(:disabled) {\n  background-color: var(--primary-color);\n  color: white;\n  border-color: var(--primary-color);\n}\n\n.range-button:disabled {\n  opacity: 0.5;\n  cursor: not-allowed;\n}\n\n@media (max-width: 768px) {\n  .metrics-filters {\n    flex-direction: column;\n    align-items: flex-start;\n  }\n\n  .filter-group {\n    width: 100%;\n    margin-bottom: 1rem;\n  }\n\n  .filter-group input,\n  .filter-group select {\n    width: 100%;\n    margin-bottom: 0.5rem;\n  }\n\n  .range-selector {\n    width: 100%;\n    justify-content: flex-start;\n  }\n\n  .metrics-title {\n    flex-direction: column;\n    align-items: flex-start;\n  }\n\n  .metrics-header h3 {\n    margin-bottom: 0.5rem;\n  }\n\n  .package-count {\n    margin-left: 0;\n  }\n\n  .metrics-grid {\n    grid-template-columns: 1fr;\n  }\n}\n\n.metrics-content {\n  display: flex;\n  flex-direction: column;\n  gap: 1.5rem;\n}\n\n.package-summary {\n  display: grid;\n  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));\n  gap: 1rem;\n  background-color: var(--light-color);\n  border-radius: 8px;\n  padding: 1.5rem;\n  margin-bottom: 0.5rem;\n}\n\n.summary-item {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  text-align: center;\n}\n\n.summary-label {\n  font-size: var(--font-size-sm);\n  color: var(--secondary-color);\n  margin-bottom: 0.5rem;\n}\n\n.summary-value {\n  font-size: var(--font-size-lg);\n  font-weight: var(--font-weight-bold);\n  color: var(--dark-color);\n}\n\n.summary-value.excellent {\n  color: var(--success-color);\n}\n\n.summary-value.good {\n  color: var(--primary-color);\n}\n\n.summary-value.fair {\n  color: var(--warning-color);\n}\n\n.summary-value.poor {\n  color: var(--danger-color);\n}\n\n.metrics-grid {\n  display: grid;\n  grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));\n  gap: 1.5rem;\n}\n\n.metric-card {\n  background: var(--light-color);\n  border-radius: 8px;\n  padding: 1.5rem;\n  transition: transform 0.2s ease;\n}\n\n.metric-card:hover {\n  transform: translateY(-2px);\n}\n\n.empty-metrics {\n  padding: 2rem;\n  text-align: center;\n  background-color: var(--light-color);\n  border-radius: 8px;\n  color: var(--secondary-color);\n  font-style: italic;\n}\n\n.metric-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 1rem;\n}\n\n.metric-header h4 {\n  font-size: var(--font-size-lg);\n  font-weight: var(--font-weight-semibold);\n  color: var(--dark-color);\n}\n\n.metric-badge {\n  padding: 0.25rem 0.75rem;\n  border-radius: 9999px;\n  font-size: var(--font-size-sm);\n  font-weight: var(--font-weight-medium);\n}\n\n.metric-badge.excellent {\n  background: rgba(16, 185, 129, 0.1);\n  color: rgb(16, 185, 129);\n}\n\n.metric-badge.good {\n  background: rgba(37, 99, 235, 0.1);\n  color: rgb(37, 99, 235);\n}\n\n.metric-badge.fair {\n  background: rgba(245, 158, 11, 0.1);\n  color: rgb(245, 158, 11);\n}\n\n.metric-badge.poor {\n  background: rgba(220, 38, 38, 0.1);\n  color: rgb(220, 38, 38);\n}\n\n.metric-details {\n  margin-bottom: 1.5rem;\n}\n\n.metric-row {\n  display: flex;\n  justify-content: space-between;\n  margin-bottom: 0.5rem;\n}\n\n.metric-label {\n  color: var(--secondary-color);\n  font-size: var(--font-size-sm);\n}\n\n.metric-value {\n  font-weight: var(--font-weight-medium);\n  color: var(--dark-color);\n}\n\n.metric-progress {\n  margin-top: 1rem;\n}\n\n.progress-bar {\n  height: 6px;\n  background: var(--light-color);\n  border-radius: 3px;\n  overflow: hidden;\n  margin-bottom: 0.5rem;\n}\n\n.progress-fill {\n  height: 100%;\n  transition: width 0.3s ease;\n}\n\n.progress-fill.excellent {\n  background: rgb(16, 185, 129);\n}\n\n.progress-fill.good {\n  background: rgb(37, 99, 235);\n}\n\n.progress-fill.fair {\n  background: rgb(245, 158, 11);\n}\n\n.progress-fill.poor {\n  background: rgb(220, 38, 38);\n}\n\n.progress-label {\n  font-size: var(--font-size-xs);\n  color: var(--secondary-color);\n}\n\n/* Loading state styles */\n.loading-state {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  padding: 3rem;\n  background-color: var(--light-color);\n  border-radius: 8px;\n  text-align: center;\n}\n\n.loading-spinner {\n  width: 40px;\n  height: 40px;\n  border: 3px solid rgba(13, 148, 136, 0.2);\n  border-radius: 50%;\n  border-top-color: var(--primary-color);\n  animation: spin 1s ease-in-out infinite;\n  margin-bottom: 1rem;\n}\n\n@keyframes spin {\n  to { transform: rotate(360deg); }\n}\n\n/* Empty state styles */\n.empty-state {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  padding: 3rem;\n  background-color: var(--light-color);\n  border-radius: 8px;\n  text-align: center;\n}\n\n.empty-icon {\n  font-size: 3rem;\n  margin-bottom: 1rem;\n  opacity: 0.7;\n}\n\n.reset-button {\n  margin-top: 1rem;\n  padding: 0.5rem 1.5rem;\n  background-color: var(--primary-color);\n  color: white;\n  border: none;\n  border-radius: 4px;\n  cursor: pointer;\n  font-weight: var(--font-weight-medium);\n  transition: background-color 0.2s ease;\n}\n\n.reset-button:hover {\n  background-color: var(--primary-hover);\n}\n</style>"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}